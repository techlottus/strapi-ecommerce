(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[2282],{51509:function(x,E,e){"use strict";e.r(E),e.d(E,{ProvidersPage:function(){return ue},default:function(){return Ce}});var t=e(32735),a=e(67879),n=e(24989),s=e(23973),i=e.n(s),l=e(23940),r=e.n(l),o=e(94638),u=e(96709),h=e(27649),p=e(82055),v=e(17e3),D=e(56755),R=e(33827),d=e(94547),m=e(19786),g=e(49372),P=e(3685),O=e(35658),Z=e(50563),K=e(68625),N=e(20108),f=e(24346),b=e(59677);const ne={id:(0,b.OB)("PopUpForm.Providers.redirectURL.front-end.label"),defaultMessage:"The redirect URL to your front-end app"},ae={id:"http://www.client-app.com",defaultMessage:"http://www.client-app.com"},Q={id:(0,b.OB)("PopUpForm.Providers.enabled.description"),defaultMessage:"If disabled, users won't be able to use this provider."},J={id:(0,b.OB)("PopUpForm.Providers.enabled.label"),defaultMessage:"Enable"},re={id:(0,b.OB)("PopUpForm.Providers.key.label"),defaultMessage:"Client ID"},se={id:(0,b.OB)("PopUpForm.Providers.redirectURL.label"),defaultMessage:"The redirect URL to add in your {provider} application configurations"},H={id:(0,b.OB)("PopUpForm.Providers.key.placeholder"),defaultMessage:"TEXT"},ie={id:(0,b.OB)("PopUpForm.Providers.secret.label"),defaultMessage:"Client Secret"};var Y={email:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6}]],schema:f.Ry().shape({enabled:f.Xg().required(n.I0.required)})},providers:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6,validations:{required:!0}}],[{intlLabel:re,name:"key",type:"text",placeholder:H,size:12,validations:{required:!0}}],[{intlLabel:ie,name:"secret",type:"text",placeholder:H,size:12,validations:{required:!0}}],[{intlLabel:ne,placeholder:ae,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:se,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:f.Ry().shape({enabled:f.Xg().required(n.I0.required),key:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()}),secret:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()}),callback:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()})})},providersWithSubdomain:{form:[[{intlLabel:J,name:"enabled",type:"bool",description:Q,size:6,validations:{required:!0}}],[{intlLabel:re,name:"key",type:"text",placeholder:H,size:12,validations:{required:!0}}],[{intlLabel:ie,name:"secret",type:"text",placeholder:H,size:12,validations:{required:!0}}],[{intlLabel:{id:(0,b.OB)({id:"PopUpForm.Providers.jwksurl.label"}),defaultMessage:"JWKS URL"},name:"jwksurl",type:"text",placeholder:H,size:12,validations:{required:!1}}],[{intlLabel:{id:(0,b.OB)("PopUpForm.Providers.subdomain.label"),defaultMessage:"Host URI (Subdomain)"},name:"subdomain",type:"text",placeholder:{id:(0,b.OB)("PopUpForm.Providers.subdomain.placeholder"),defaultMessage:"my.subdomain.com"},size:12,validations:{required:!0}}],[{intlLabel:ne,placeholder:ae,name:"callback",type:"text",size:12,validations:{required:!0}}],[{intlLabel:se,name:"noName",type:"text",validations:{},size:12,disabled:!0}]],schema:f.Ry().shape({enabled:f.Xg().required(n.I0.required),key:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()}),secret:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()}),subdomain:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()}),callback:f.Z_().when("enabled",{is:!0,then:f.Z_().required(n.I0.required),otherwise:f.Z_()})})}};const fe=async y=>{try{const{get:L}=(0,n.tg)(),{data:j}=await L((0,b.Gc)("providers"));return j}catch{throw y({type:"warning",message:{id:"notification.error"}}),new Error("error")}},pe=y=>{const{put:L}=(0,n.tg)();return L((0,b.Gc)("providers"),y)};var ve=e(98978),ge=e.n(ve),he=y=>ge()(Object.keys(y).reduce((L,j)=>{const{icon:C,enabled:T,subdomain:S}=y[j],A=C==="envelope"?["fas","envelope"]:["fab",C];return S!==void 0?L.push({name:j,icon:A,enabled:T,subdomain:S}):L.push({name:j,icon:A,enabled:T}),L},[]),"name"),oe=e(88369),ye=e(85025),Ee=e(55225),de=e(11299),xe=e(31600),Pe=e(87933),be=e(15335),Me=e(5803),Oe=e(11406),le=e(41415),Le=e(60216),c=e.n(Le),Be=e(92802),Te=e(9139),Re=e(10369);const w=({description:y,disabled:L,intlLabel:j,error:C,name:T,onChange:S,placeholder:A,providerToEditName:F,type:W,value:M})=>{const{formatMessage:U}=(0,a.Z)(),z=T==="noName"?`${strapi.backendURL}/api/connect/${F}/callback`:M,$=U({id:j.id,defaultMessage:j.defaultMessage},{provider:F,...j.values}),I=y?U({id:y.id,defaultMessage:y.defaultMessage},{provider:F,...y.values}):"";if(W==="bool")return t.createElement(Te.s,{"aria-label":T,checked:M,disabled:L,hint:I,label:$,name:T,offLabel:U({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:U({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:G=>{S({target:{name:T,value:G.target.checked}})}});const q=A?U({id:A.id,defaultMessage:A.defaultMessage},{...A.values}):"",_=C?U({id:C,defaultMessage:C}):"";return t.createElement(Re.o,{"aria-label":T,disabled:L,error:_,label:$,name:T,onChange:S,placeholder:q,type:W,value:z})};w.defaultProps={description:null,disabled:!1,error:"",placeholder:null,value:""},w.propTypes={description:c().shape({id:c().string.isRequired,defaultMessage:c().string.isRequired,values:c().object}),disabled:c().bool,error:c().string,intlLabel:c().shape({id:c().string.isRequired,defaultMessage:c().string.isRequired,values:c().object}).isRequired,name:c().string.isRequired,onChange:c().func.isRequired,placeholder:c().shape({id:c().string.isRequired,defaultMessage:c().string.isRequired,values:c().object}),providerToEditName:c().string.isRequired,type:c().string.isRequired,value:c().oneOfType([c().bool,c().string])};var je=w;const k=({headerBreadcrumbs:y,initialData:L,isSubmiting:j,layout:C,isOpen:T,onSubmit:S,onToggle:A,providerToEditName:F})=>{const{formatMessage:W}=(0,a.Z)();return T?t.createElement(ye.P,{onClose:A,labelledBy:"title"},t.createElement(Ee.x,null,t.createElement(de.O,{label:y.join(", ")},y.map(M=>t.createElement(de.$,{key:M},M)))),t.createElement(Be.J9,{onSubmit:M=>S(M),initialValues:L,validationSchema:C.schema,validateOnChange:!1},({errors:M,handleChange:U,values:z})=>t.createElement(n.l0,null,t.createElement(xe.f,null,t.createElement(Pe.k,{direction:"column",alignItems:"stretch",gap:1},t.createElement(be.r,{gap:5},C.form.map($=>$.map(I=>t.createElement(Me.P,{key:I.name,col:I.size,xs:12},t.createElement(je,{...I,error:M[I.name],onChange:U,value:z[I.name],providerToEditName:F}))))))),t.createElement(Oe.m,{startActions:t.createElement(le.z,{variant:"tertiary",onClick:A,type:"button"},W({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:t.createElement(le.z,{type:"submit",loading:j},W({id:"global.save",defaultMessage:"Save"}))})))):null};k.defaultProps={initialData:null,providerToEditName:null},k.propTypes={headerBreadcrumbs:c().arrayOf(c().string).isRequired,initialData:c().object,layout:c().shape({form:c().arrayOf(c().array),schema:c().object}).isRequired,isOpen:c().bool.isRequired,isSubmiting:c().bool.isRequired,onSubmit:c().func.isRequired,onToggle:c().func.isRequired,providerToEditName:c().string};var Ae=k;const ue=()=>{const{formatMessage:y}=(0,a.Z)();(0,n.go)();const{notifyStatus:L}=(0,o.G)(),j=(0,N.useQueryClient)(),{trackUsage:C}=(0,n.rS)(),T=(0,t.useRef)(C),[S,A]=(0,t.useState)(!1),[F,W]=(0,t.useState)(!1),[M,U]=(0,t.useState)(null),z=(0,n.lm)(),{lockApp:$,unlockApp:I}=(0,n.o1)(),q=(0,t.useMemo)(()=>({update:oe.Z.updateProviders}),[]),{isLoading:_,allowedActions:{canUpdate:G}}=(0,n.ss)(q),{isLoading:De,data:V,isFetching:Ze}=(0,N.useQuery)("get-providers",()=>fe(z),{onSuccess(){L(y({id:(0,b.OB)("Providers.data.loaded"),defaultMessage:"Providers have been loaded"}))},initialData:{}}),Ue=De||Ze,Ie=(0,N.useMutation)(pe,{async onSuccess(){await j.invalidateQueries("get-providers"),z({type:"info",message:{id:(0,b.OB)("notification.success.submit")}}),T.current("didEditAuthenticationProvider"),W(!1),ee(),I()},onError(){z({type:"warning",message:{id:"notification.error"}}),I(),W(!1)},refetchActive:!1}),X=(0,t.useMemo)(()=>he(V),[V]),Se=X.length,ce=(0,t.useMemo)(()=>{if(!M)return!1;const B=X.find(te=>te.name===M);return i()(B,"subdomain")},[X,M]),We=y({id:(0,b.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"}),Fe=(0,t.useMemo)(()=>M==="email"?Y.email:ce?Y.providersWithSubdomain:Y.providers,[M,ce]),ee=()=>{A(B=>!B)},me=B=>{G&&(U(B.name),ee())},ze=async B=>{W(!0),$(),T.current("willEditAuthenticationProvider");const te={...V,[M]:B};Ie.mutate({providers:te})};return t.createElement(u.A,null,t.createElement(n.SL,{name:We}),t.createElement(h.o,null,t.createElement(p.T,{title:y({id:(0,b.OB)("HeaderNav.link.providers"),defaultMessage:"Providers"})}),Ue||_?t.createElement(n.dO,null):t.createElement(v.D,null,t.createElement(D.i,{colCount:3,rowCount:Se+1},t.createElement(R.h,null,t.createElement(d.Tr,null,t.createElement(m.Th,null,t.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},y({id:"global.name",defaultMessage:"Name"}))),t.createElement(m.Th,null,t.createElement(g.Z,{variant:"sigma",textColor:"neutral600"},y({id:(0,b.OB)("Providers.status"),defaultMessage:"Status"}))),t.createElement(m.Th,null,t.createElement(g.Z,{variant:"sigma"},t.createElement(P.T,null,y({id:"global.settings",defaultMessage:"Settings"})))))),t.createElement(O.p,null,X.map(B=>t.createElement(d.Tr,{key:B.name,...(0,n.X7)({fn:()=>me(B),condition:G})},t.createElement(m.Td,{width:"45%"},t.createElement(g.Z,{fontWeight:"semiBold",textColor:"neutral800"},B.name)),t.createElement(m.Td,{width:"65%"},t.createElement(g.Z,{textColor:B.enabled?"success600":"danger600","data-testid":`enable-${B.name}`},B.enabled?y({id:"global.enabled",defaultMessage:"Enabled"}):y({id:"global.disabled",defaultMessage:"Disabled"}))),t.createElement(m.Td,{...n.UW},G&&t.createElement(Z.h,{onClick:()=>me(B),noBorder:!0,icon:t.createElement(K.Z,null),label:"Edit"})))))))),t.createElement(Ae,{initialData:V[M],isOpen:S,isSubmiting:F,layout:Fe,headerBreadcrumbs:[y({id:(0,b.OB)("PopUpForm.header.edit.providers"),defaultMessage:"Edit Provider"}),r()(M)],onToggle:ee,onSubmit:ze,providerToEditName:M}))};var Ce=()=>t.createElement(n.O4,{permissions:oe.Z.readProviders},t.createElement(ue,null))},59677:function(x,E,e){"use strict";e.d(E,{YX:function(){return s},Gc:function(){return r},OB:function(){return o.Z}});var t=e(86834),a=e.n(t),s=u=>Object.keys(u).reduce((h,p)=>{const v=u[p].controllers,D=Object.keys(v).reduce((R,d)=>(a()(v[d])||(R[d]=v[d]),R),{});return a()(D)||(h[p]={controllers:D}),h},{}),i=e(90201),r=u=>`/${i.Z}/${u}`,o=e(82069)},56671:function(x,E,e){var t=e(35897),a=e(74741),n=a(t);x.exports=n},52920:function(x,E,e){var t=e(56671),a=e(81580);function n(s,i){var l=-1,r=a(s)?Array(s.length):[];return t(s,function(o,u,h){r[++l]=i(o,u,h)}),r}x.exports=n},50690:function(x,E,e){var t=e(26460),a=e(80166),n=e(88904),s=e(52920),i=e(36024),l=e(76535),r=e(1397),o=e(15362),u=e(77236);function h(p,v,D){v.length?v=t(v,function(m){return u(m)?function(g){return a(g,m.length===1?m[0]:m)}:m}):v=[o];var R=-1;v=t(v,l(n));var d=s(p,function(m,g,P){var O=t(v,function(Z){return Z(m)});return{criteria:O,index:++R,value:m}});return i(d,function(m,g){return r(m,g,D)})}x.exports=h},36024:function(x){function E(e,t){var a=e.length;for(e.sort(t);a--;)e[a]=e[a].value;return e}x.exports=E},40709:function(x,E,e){var t=e(22945);function a(n,s){if(n!==s){var i=n!==void 0,l=n===null,r=n===n,o=t(n),u=s!==void 0,h=s===null,p=s===s,v=t(s);if(!h&&!v&&!o&&n>s||o&&u&&p&&!h&&!v||l&&u&&p||!i&&p||!r)return 1;if(!l&&!o&&!v&&n<s||v&&i&&r&&!l&&!o||h&&i&&r||!u&&r||!p)return-1}return 0}x.exports=a},1397:function(x,E,e){var t=e(40709);function a(n,s,i){for(var l=-1,r=n.criteria,o=s.criteria,u=r.length,h=i.length;++l<u;){var p=t(r[l],o[l]);if(p){if(l>=h)return p;var v=i[l];return p*(v=="desc"?-1:1)}}return n.index-s.index}x.exports=a},74741:function(x,E,e){var t=e(81580);function a(n,s){return function(i,l){if(i==null)return i;if(!t(i))return n(i,l);for(var r=i.length,o=s?r:-1,u=Object(i);(s?o--:++o<r)&&l(u[o],o,u)!==!1;);return i}}x.exports=a},98978:function(x,E,e){var t=e(40314),a=e(50690),n=e(94569),s=e(63108),i=n(function(l,r){if(l==null)return[];var o=r.length;return o>1&&s(l,r[0],r[1])?r=[]:o>2&&s(r[0],r[1],r[2])&&(r=[r[0]]),a(l,t(r,1),[])});x.exports=i},11299:function(x,E,e){"use strict";e.d(E,{$:function(){return u},O:function(){return h}});var t=e(74512),a=e(77277),n=e(8471),s=e(3685),i=e(87933),l=e(72850),r=e(49372);const o=(0,n.ZP)(i.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:p})=>p.colors.neutral500};
    }
  }
  :last-of-type ${l.x} {
    display: none;
  }
  :last-of-type ${r.Z} {
    color: ${({theme:p})=>p.colors.neutral800};
    font-weight: ${({theme:p})=>p.fontWeights.bold};
  }
`,u=({children:p})=>(0,t.jsxs)(o,{inline:!0,as:"li",children:[(0,t.jsx)(r.Z,{variant:"pi",textColor:"neutral600",children:p}),(0,t.jsx)(l.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,t.jsx)(a.Z,{})})]});u.displayName="Crumb";const h=({children:p,label:v,...D})=>(0,t.jsxs)(i.k,{...D,children:[(0,t.jsx)(s.T,{children:v}),(0,t.jsx)("ol",{"aria-hidden":!0,children:p})]});h.displayName="Breadcrumbs"},17e3:function(x,E,e){"use strict";e.d(E,{D:function(){return i}});var t=e(74512),a=e(32735),n=e(60216),s=e(72850);const i=({children:l})=>(0,t.jsx)(s.x,{paddingLeft:10,paddingRight:10,children:l});i.propTypes={children:n.node.isRequired}},82055:function(x,E,e){"use strict";e.d(E,{T:function(){return v}});var t=e(74512),a=e(32735),n=e(60216),s=e(8471);const i=d=>{const m=(0,a.useRef)(null),[g,P]=(0,a.useState)(!0),O=([Z])=>{P(Z.isIntersecting)};return(0,a.useEffect)(()=>{const Z=m.current,K=new IntersectionObserver(O,d);return Z&&K.observe(m.current),()=>{Z&&K.disconnect()}},[m,d]),[m,g]};var l=e(63060);const r=(d,m)=>{const g=(0,l.W)(m);(0,a.useLayoutEffect)(()=>{const P=new ResizeObserver(g);return Array.isArray(d)?d.forEach(O=>{O.current&&P.observe(O.current)}):d.current&&P.observe(d.current),()=>{P.disconnect()}},[d,g])};var o=e(72850),u=e(87933),h=e(49372);const p=()=>{const d=(0,a.useRef)(null),[m,g]=(0,a.useState)(null),[P,O]=i({root:null,rootMargin:"0px",threshold:0});return r(P,()=>{P.current&&g(P.current.getBoundingClientRect())}),(0,a.useEffect)(()=>{d.current&&g(d.current.getBoundingClientRect())},[d]),{containerRef:P,isVisible:O,baseHeaderLayoutRef:d,headerSize:m}},v=d=>{const{containerRef:m,isVisible:g,baseHeaderLayoutRef:P,headerSize:O}=p();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{height:O?.height},ref:m,children:g&&(0,t.jsx)(R,{ref:P,...d})}),!g&&(0,t.jsx)(R,{...d,sticky:!0,width:O?.width})]})};v.displayName="HeaderLayout";const D=(0,s.ZP)(o.x)`
  width: ${d=>d.width}px;
  z-index: ${({theme:d})=>d.zIndices[1]};
`,R=a.forwardRef(({navigationAction:d,primaryAction:m,secondaryAction:g,subtitle:P,title:O,sticky:Z,width:K,...N},f)=>{const b=typeof P=="string";return Z?(0,t.jsx)(D,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:K,"data-strapi-header-sticky":!0,children:(0,t.jsxs)(u.k,{justifyContent:"space-between",children:[(0,t.jsxs)(u.k,{children:[d&&(0,t.jsx)(o.x,{paddingRight:3,children:d}),(0,t.jsxs)(o.x,{children:[(0,t.jsx)(h.Z,{variant:"beta",as:"h1",...N,children:O}),b?(0,t.jsx)(h.Z,{variant:"pi",textColor:"neutral600",children:P}):P]}),g?(0,t.jsx)(o.x,{paddingLeft:4,children:g}):null]}),(0,t.jsx)(u.k,{children:m?(0,t.jsx)(o.x,{paddingLeft:2,children:m}):void 0})]})}):(0,t.jsxs)(o.x,{ref:f,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:d?6:8,background:"neutral100","data-strapi-header":!0,children:[d?(0,t.jsx)(o.x,{paddingBottom:2,children:d}):null,(0,t.jsxs)(u.k,{justifyContent:"space-between",children:[(0,t.jsxs)(u.k,{minWidth:0,children:[(0,t.jsx)(h.Z,{as:"h1",variant:"alpha",...N,children:O}),g?(0,t.jsx)(o.x,{paddingLeft:4,children:g}):null]}),m]}),b?(0,t.jsx)(h.Z,{variant:"epsilon",textColor:"neutral600",as:"p",children:P}):P]})});R.displayName="BaseHeaderLayout",R.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0,sticky:!1,width:void 0},R.propTypes={navigationAction:n.node,primaryAction:n.node,secondaryAction:n.node,sticky:n.bool,subtitle:n.oneOfType([n.string,n.node]),title:n.string.isRequired,width:n.number},v.defaultProps={navigationAction:void 0,primaryAction:void 0,secondaryAction:void 0,subtitle:void 0},v.propTypes={navigationAction:n.node,primaryAction:n.node,secondaryAction:n.node,subtitle:n.oneOfType([n.string,n.node]),title:n.string.isRequired}},96709:function(x,E,e){"use strict";e.d(E,{A:function(){return o}});var t=e(74512),a=e(32735),n=e(60216),s=e(8471),i=e(72850);const l=(0,s.ZP)(i.x)`
  display: grid;
  grid-template-columns: ${({hasSideNav:u})=>u?"auto 1fr":"1fr"};
`,r=(0,s.ZP)(i.x)`
  overflow-x: hidden;
`,o=({sideNav:u,children:h})=>(0,t.jsxs)(l,{hasSideNav:!!u,children:[u,(0,t.jsx)(r,{paddingBottom:10,children:h})]});o.defaultProps={sideNav:void 0},o.propTypes={children:n.node.isRequired,sideNav:n.node}},27649:function(x,E,e){"use strict";e.d(E,{o:function(){return i}});var t=e(74512),a=e(8471),n=e(72850);const s=(0,a.ZP)(n.x)`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,i=({labelledBy:l="main-content-title",...r})=>(0,t.jsx)(s,{"aria-labelledby":l,as:"main",id:"main-content",tabIndex:-1,...r})}}]);
