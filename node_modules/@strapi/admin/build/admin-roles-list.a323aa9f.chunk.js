"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3455],{67249:function(H,j,t){t.r(j),t.d(j,{default:function(){return me}});var e=t(32735),s=t(24989),v=t(83983),O=t(47765),D=t(68625),Z=t(4038),x=t(19406),I=t(27649),A=t(82055),u=t(41415),R=t(99223),g=t(17e3),S=t(56755),F=t(73269),G=t(33827),Q=t(94547),C=t(19786),W=t(49372),J=t(3685),Y=t(35658),k=t(33795),w=t.n(k),$=t(67879),q=t(53038),_=t(67927),ee=()=>"todo empty role",te=t(60216),B=t.n(te),ne=t(87933),le=t(72850),se=t(50563);const N=({id:a,name:o,description:n,usersCount:h,icons:r,rowIndex:m,canUpdate:p})=>{const{formatMessage:T}=(0,$.Z)(),[,i]=r,M=T({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:h});return e.createElement(Q.Tr,{"aria-rowindex":m,key:a,...p?(0,s.X7)({fn:i.onClick}):{}},e.createElement(C.Td,{maxWidth:(0,s.Q1)(130)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},o)),e.createElement(C.Td,{maxWidth:(0,s.Q1)(250)},e.createElement(W.Z,{ellipsis:!0,textColor:"neutral800"},n)),e.createElement(C.Td,null,e.createElement(W.Z,{textColor:"neutral800"},M)),e.createElement(C.Td,null,e.createElement(ne.k,{justifyContent:"flex-end",...s.UW},r.map((d,P)=>d?e.createElement(le.x,{key:d.label,paddingLeft:P===0?0:1},e.createElement(se.h,{onClick:d.onClick,label:d.label,noBorder:!0,icon:d.icon})):null))))};N.propTypes={id:B().number.isRequired,name:B().string.isRequired,description:B().string.isRequired,usersCount:B().number.isRequired,icons:B().array.isRequired,rowIndex:B().number.isRequired,canUpdate:B().bool},N.defaultProps={canUpdate:!1};var ae=N,oe=t(97889);const re={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1};var ie=(a,o)=>(0,oe.ZP)(a,n=>{switch(o.type){case"ON_REMOVE_ROLES":{n.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{n.shouldRefetchData=!0,n.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{n.shouldRefetchData=!1,n.roleToDelete=null,n.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{n.roleToDelete=o.id;break}default:return n}});const de=()=>{(0,s.go)();const{locale:a}=(0,$.Z)(),{isLoading:o,allowedActions:{canCreate:n,canDelete:h,canRead:r,canUpdate:m}}=(0,s.ss)(v.Z.settings.roles),{getData:p,roles:T,isLoading:i}=(0,_.bF)(!1),[{query:M}]=(0,s.Kx)(),d=M?._q||"",{includes:P}=(0,s.L0)(a,{sensitivity:"base"}),y=(0,s.Xe)(a,{sensitivity:"base"}),U=(T||[]).filter(f=>P(f.name,d)||P(f.description,d)).sort((f,L)=>y.compare(f.name,L.name)||y.compare(f.description,L.description));return(0,e.useEffect)(()=>{!o&&r&&p()},[o,r,p]),{isLoadingForPermissions:o,canCreate:n,canDelete:h,canRead:r,canUpdate:m,isLoading:i,getData:p,sortedRoles:U,roles:T}},ce=({getData:a,canCreate:o,canDelete:n,canUpdate:h})=>{const{formatMessage:r}=(0,$.Z)(),m=(0,s.lm)(),[p,T]=(0,e.useState)(!1),{push:i}=(0,q.k6)(),[{selectedRoles:M,showModalConfirmButtonLoading:d,roleToDelete:P},y]=(0,e.useReducer)(ie,re),{post:U}=(0,s.tg)(),f=async()=>{try{y({type:"ON_REMOVE_ROLES"}),await U("/admin/roles/batch-delete",{ids:[P]}),await a(),y({type:"RESET_DATA_TO_DELETE"})}catch(l){const c=w()(l,["response","payload","data","ids"],null);if(c&&Array.isArray(c)){const ge=c.join(`
`);m({type:"warning",message:ge})}else m({type:"warning",message:{id:"notification.error"}})}E()},L=(0,e.useCallback)(l=>{i(`/settings/roles/duplicate/${l}`)},[i]),V=()=>i("/settings/roles/new"),K=(0,e.useCallback)(l=>{y({type:"SET_ROLE_TO_DELETE",id:l}),E()},[]),E=()=>T(l=>!l),b=(0,e.useCallback)(l=>{i(`/settings/roles/${l}`)},[i]),z=(0,e.useCallback)((l,c)=>{l.preventDefault(),l.stopPropagation(),c.usersCount?m({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):K(c.id)},[m,K]),X=(0,e.useCallback)((l,c)=>{l.preventDefault(),l.stopPropagation(),L(c.id)},[L]),Ee=(0,e.useCallback)(l=>[...o?[{onClick:c=>X(c,l),label:r({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(O.Z,null)}]:[],...h?[{onClick:()=>b(l.id),label:r({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(D.Z,null)}]:[],...n?[{onClick:c=>z(c,l),label:r({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(Z.Z,null)}]:[]],[r,z,X,b,o,h,n]);return{handleNewRoleClick:V,getIcons:Ee,selectedRoles:M,isWarningDeleteAllOpened:p,showModalConfirmButtonLoading:d,handleToggleModal:E,handleDeleteData:f}};var ue=()=>{const{formatMessage:a}=(0,$.Z)(),{isLoadingForPermissions:o,canCreate:n,canRead:h,canDelete:r,canUpdate:m,isLoading:p,getData:T,sortedRoles:i}=de(),{handleNewRoleClick:M,getIcons:d,isWarningDeleteAllOpened:P,showModalConfirmButtonLoading:y,handleToggleModal:U,handleDeleteData:f}=ce({getData:T,canCreate:n,canDelete:r,canUpdate:m}),L=i.length+1,V=6;if(o)return e.createElement(I.o,null,e.createElement(s.dO,null));const K=a({id:"global.roles",defaultMessage:"roles"});return e.createElement(I.o,null,e.createElement(s.SL,{name:"Roles"}),e.createElement(A.T,{primaryAction:n?e.createElement(u.z,{onClick:M,startIcon:e.createElement(x.Z,null),size:"S"},a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:K,subtitle:a({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),h&&e.createElement(R.Z,{startActions:e.createElement(s.m,{label:a({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:K})})}),h&&e.createElement(g.D,null,e.createElement(S.i,{colCount:V,rowCount:L,footer:n?e.createElement(F.c,{onClick:M,icon:e.createElement(x.Z,null)},a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(G.h,null,e.createElement(Q.Tr,{"aria-rowindex":1},e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.name",defaultMessage:"Name"}))),e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.description",defaultMessage:"Description"}))),e.createElement(C.Th,null,e.createElement(W.Z,{variant:"sigma",textColor:"neutral600"},a({id:"global.users",defaultMessage:"Users"}))),e.createElement(C.Th,null,e.createElement(J.T,null,a({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(Y.p,null,i?.map((E,b)=>e.createElement(ae,{key:E.id,id:E.id,name:E.name,description:E.description,usersCount:E.usersCount,icons:d(E),rowIndex:b+2,canUpdate:m})))),!L&&!p&&e.createElement(ee,null)),e.createElement(s.QH,{isOpen:P,onConfirm:f,isConfirmButtonLoading:y,onToggleDialog:U}))},me=()=>e.createElement(s.O4,{permissions:v.Z.settings.roles.main},e.createElement(ue,null))},99223:function(H,j,t){t.d(j,{Z:function(){return A}});var e=t(74512),s=t(32735),v=t(60216),O=t(8471),D=t(87933),Z=t(72850);const x=(0,O.ZP)(D.k)`
  & > * + * {
    margin-left: ${({theme:u})=>u.spaces[2]};
  }

  margin-left: ${({pullRight:u})=>u?"auto":void 0};
`,I=(0,O.ZP)(x)`
  flex-shrink: 0;
`,A=({startActions:u,endActions:R})=>u||R?(0,e.jsx)(Z.x,{paddingLeft:10,paddingRight:10,children:(0,e.jsx)(Z.x,{paddingBottom:4,children:(0,e.jsxs)(D.k,{justifyContent:"space-between",alignItems:"flex-start",children:[u&&(0,e.jsx)(x,{wrap:"wrap",children:u}),R&&(0,e.jsx)(I,{pullRight:!0,children:R})]})})}):null;A.defaultProps={endActions:void 0,startActions:void 0},A.propTypes={endActions:v.node,startActions:v.node}},73269:function(H,j,t){t.d(j,{c:function(){return R}});var e=t(74512),s=t(32735),v=t(60216),O=t(8471),D=t(72850),Z=t(9026),x=t(87933),I=t(49372);const A=(0,O.ZP)(D.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:g})=>g.colors.primary600};
  }
`,u=(0,O.ZP)(D.x)`
  border-radius: 0 0 ${({theme:g})=>g.borderRadius} ${({theme:g})=>g.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,R=({children:g,icon:S,...F})=>(0,e.jsxs)("div",{children:[(0,e.jsx)(Z.i,{}),(0,e.jsx)(u,{as:"button",background:"primary100",padding:5,...F,children:(0,e.jsxs)(x.k,{children:[(0,e.jsx)(A,{"aria-hidden":!0,background:"primary200",children:S}),(0,e.jsx)(D.x,{paddingLeft:3,children:(0,e.jsx)(I.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:g})})]})})]});R.propTypes={children:v.string.isRequired,icon:v.node.isRequired}}}]);
